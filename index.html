<!DOCTYPE html>
<html>
    
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>WECHAT GAME 大轉盤</title>
        <meta name="description" content="Taiki 官方企業抽獎">
        <link rel="stylesheet" href="src/css/typo/typo.css">
        <link rel="stylesheet" href="src/css/GB-canvas-turntable.css">
        <link rel="stylesheet" href="src/css/GB-canvas-turntable.scss">
        <script src="src/js/GB-canvas-turntable.js"></script>
        <link rel="stylesheet" href="src/css/style.css">
    </head>
  <body ontouchstart>
    
	<div class="wrapper typo" id="wrapper">
		<h1>淘寶搜Taiki</h1>

        <section id="turntable" class="gb-turntable">
        <div class="gb-turntable-container">
            <canvas class="gb-turntable-canvas" width="300px" height="300px">Error 瀏覽器不支援</canvas> 
        </div>

        <a class="gb-turntable-btn" href="javascript:;">抽奖</a>    
    </section></div>
   
    
    <div class="remain">
            <div>剩餘次數:<span id="chance">3
            </span></div>
    </div>
    
   <div class="awardlist">
       <ul class="main">
           <li>一等獎:台奇內循環扇1台 價值595元</li>
           <li>二等獎:台奇晴雨守護大傘 價值100元</li>
           <li>三等獎:台奇玻璃保溫杯價值 價值80元 </li>
           <li>四等獎:濕紙巾</li>
           <li>五等獎:農夫山泉</li>
       </ul>
   </div>
    <script>
      //
        var last_time = document.getElementById("chance");
        last_time=3;
        console.log(last_time);

        document.addEventListener('DOMContentLoaded', function() {
         
            gbTurntable.init({
                id: 'turntable',
                config: function(callback){
                    // 获取奖品信息
                    callback && callback(['銘謝惠顧','五等獎','四等獎','三等獎','二等獎','一等獎']);
                
                },
                getPrize: function(callback) {
                    // 中獎訊息
                    var num = Math.random() * 5 >>> 0,   //奖品ID
                        chances = num;  // 可抽奖次数
                    　// wrong .
                    //need to fix this bug .
                        callback && callback([num, last_time]);  
                        console.log("chances"+chances);
                
                },
                gotBack: function(data) {
               
                    alert('恭喜抽中   ' + data);
                    console.log('恭喜抽中  ' + data);
                    last_time=last_time-1;
                    if(last_time=0)
                        alert("Thanks for coming");
               
                   //
                    document.getElementById("chance").innerHTML=last_time;
                    console.log(last_time);
                },
                               
                
            
            
            }); 
        }, false);
    </script> 
    </body>
</html>
